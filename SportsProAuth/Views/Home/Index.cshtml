@model IEnumerable<SportsPro.Models.Incident>
@{ ViewData["Title"] = "Technicians"; }

@if (!User.Identity.IsAuthenticated)
{<h1>SportsPro Technical Support</h1>
    <p>Sports management software for the sports enthusiast</p>
}

@{ if (User.IsInRole("Administrator"))
    {
        <h1>Admin</h1>
        <div class="list-group">
            <a asp-controller="Incidents" asp-action="Index"
               class="list-group-item">Incident Manager</a>
            <a asp-controller="Products" asp-action="Index"
               class="list-group-item">Product Manager</a>
            <a asp-controller="Technicians" asp-action="Index"
               class="list-group-item">Technician Manager</a>
            <a asp-controller="Customers" asp-action="Index"
               class="list-group-item">Customer Manager</a>
            <a asp-controller="Registrations" asp-action="Index"
               class="list-group-item">Registration Manager</a>
        </div> } }

@{ if (User.IsInRole("Technician"))
    {
        <br />
        <h3>Dashboard</h3>
        <hr />
        @if(this.Model.Count() > 0)
        {
        <nav class="nav nav-pills nav-justified">
            <a id="all-incidents" class="nav-link active" href="">All incidents</a>
            <a id="open-incidents" class="nav-link" href="">Open incidents</a>
        </nav>
        }
        <br />
        <div id="incidents">
            <partial name="_selected-incidents" model="@Model" />
        </div>
    }
}

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>

    $(document).ready(() => {

        $('#all-incidents').click((e) => {
            e.preventDefault();
            $.ajax({
                method: 'GET',
                url: '/home/GetTechIncidents',
                data: { name: 'all-incidents' }
            }).done(function (result, statusText, xhdr) {
                $('#incidents').html(result);
            });
            $('#all-incidents').addClass("active");
            $('#open-incidents').removeClass("active");
        });

        $('#open-incidents').click((e) => {
            e.preventDefault();
            $.ajax({
                method: 'GET',
                url: '/home/GetTechIncidents',
                data: { name: 'open-incidents' }
            }).done(function (result, statusText, xhdr) {
                $('#incidents').html(result);
            });
            $('#all-incidents').removeClass("active");
            $('#open-incidents').addClass("active");
        });



    });
</script>
