@model IEnumerable<SportsPro.Models.Incident>
@{ ViewData["Title"] = "Dashboard"; }

@if (!User.Identity.IsAuthenticated)
{
    <!-- Jumbotron -->
    <div class="p-5 text-center rounded-3 background-image">

        <div class="mask">
            <div class="d-flex justify-content-center align-items-center h-100">
                <div class="text-white">
                    <h1 class="mb-3">SportsPro Technical Support</h1>
                    <h4 class="mb-3">Sports management software for the sports enthusiast</h4>
                    <a class="btn btn-outline-light btn-lg" href="https://localhost:44357/identity/account/login/" role="button">Login</a>
                </div>
            </div>
        </div>
    </div>
    <!-- Jumbotron -->

}


@{ if (User.IsInRole("Technician"))
    {
        <br />
        <h3>Dashboard</h3>
        <hr />
        @if (this.Model.Count() > 0)
        {
            @*<nav class="nav nav-pills nav-justified">
                    <a id="alltechincidents" class="nav-link active" href="">All incidents</a>
                    <a id="opentechincidents" class="nav-link" href="">Open incidents</a>
                </nav>*@

            <ul class="nav nav-tabs container mb-3">

                <li class="nav-item">
                    <a id="alltechincidents" class="nav-link" href="">All Incidents</a>
                </li>
                <li class="nav-item">
                    <a id="opentechincidents" class="nav-link" href="">Open Incidents</a>
                </li>
            </ul>
        }
        <br />
        <div id="techincidents">
            <partial name="_selected-incidents" model="@Model" />
        </div>
    }
}

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>

    $(document).ready(() => {

        $('#alltechincidents').click((e) => {
            e.preventDefault();
            $.ajax({
                method: 'GET',
                url: '/home/GetTechIncidents',
                data: { name: 'all-incidents' }
            }).done(function (result, statusText, xhdr) {
                $('#techincidents').html(result);
            });
            $('#alltechincidents').addClass("active");
            $('#opentechincidents').removeClass("active");
        });

        $('#opentechincidents').click((e) => {
            e.preventDefault();
            $.ajax({
                method: 'GET',
                url: '/home/GetTechIncidents',
                data: { name: 'open-incidents' }
            }).done(function (result, statusText, xhdr) {
                $('#techincidents').html(result);
            });
            $('#alltechincidents').removeClass("active");
            $('#opentechincidents').addClass("active");
        });


        $(document).ready(() => {

            $('#unassigned-incidents').removeClass("active");
            $('#all-incidents').addClass("active");
            $('#open-incidents').removeClass("active");
        });


    });
</script>


