@model IEnumerable<SportsPro.Models.Technician>
@{
    ViewData["Title"] = "Technicians";
    var techs = new SelectList(Model, "TechnicianID", "Name");
    var tech = Model.First();
}
<h2>@ViewData["Title"]</h2>
<hr />
<div id="uxErrorMsg" style="height:15px;">
</div>
<div class="row">
    <div class="col-md-4">
        <div asp-validation-summary="All" class="text-danger"></div>
        <form>
            <div class="form-group">
                <label class="control-label"></label>
                <select id="uxTechSelection" class="form-control" asp-items="techs">
                    <option value="" selected>Select Technician</option>
                </select>
            </div>
            <button id="btnClick" value="Find Incidents" class="mb-5 mt-3 btn btn-primary" >Find Incidents</button>
        </form>
    </div>
</div>

<div id="uxIncidents">
</div>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>
   
    $(document).ready(() => {
        $('#btnClick').click((e) => {
            e.preventDefault();
            var techId = $("#uxTechSelection").val();
            if (parseInt(techId) > 0) 
                $.ajax({
                    method: 'GET',
                    url: '/incidents/techIncidents',
                    data: { id: techId }
                }).done(function (result, statusText, xhdr) {
                    $('#uxIncidents').html(result);
                    $('#uxErrorMsg').html("");
                });
            else
                $('#uxErrorMsg').html('<p class="text-danger">Please choose a technician name</p>');
            
        });
    });
</script>
